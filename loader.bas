REM  ** Pharaoh's  Curse **
REM  ** NuLA Restoration **
REM  Version 1.0 April 2022
REM Archaeology Dave Footitt
REM  Restoration Chris Hogg
REM
MODE 7
DIM REGS 4
A%=234
X%=0
Y%=0
!REGS = USR &FFF4
IF REGS?1 <> 0 PRINT '"Not compatible with TUBE":END
*FX200,3
VDU23,0,8,&30,0;0;0;
*FX9
*FX10
*FX151,32,16
*FX19
E%=FNTM
*FX151,34,68
*FX19
G%=FNTM
NULA%=E%/G%>0.75
MODE 7
IF NULA% ?&FE22=&40
PROCHEADER
PRINT
IF NULA% PRINTTAB(12)"NuLA Detected OK" ELSE PRINT" No NuLA detected - normal game will run";
PRINT
PROCKEYS
PRINT'
*FX 4,1
*FX 15
PRINT " Select fewer enemies for an easier game"
PRINT
INPUTTAB(12)"Enemies (1-5)",ENEMIES%
?&71 = FNCLAMP(ENEMIES%,1,5)+1
IF NULA% ?&70=1 ELSE ?&70=0
IF NULA% MODE2:PROCTITLE
IF NULA% ?&FE22=&40
MODE 7
PRINT '"Loading..."
CLOSE #0
*RUN PATCHER
END
DEFFNTM:LOCALI%,T%:TIME=0:FORI%=1TO5:*FX19
NEXT:T%=TIME:=T%
DEFFNCLAMP(N%,L%,H%):IF N%<L% THEN N%=L% ELSE IF N%>H% THEN N%=H%
=N%
DEFPROCHEADER
PRINT CHR$(132);CHR$(157);"      ";CHR$(135);CHR$(156);CHR$(141);" Pharaoh's  Curse  ";CHR$(132);CHR$(157)
PRINT CHR$(131);CHR$(157);"      ";CHR$(135);CHR$(156);CHR$(141);" Pharaoh's  Curse  ";CHR$(131);CHR$(157)
PRINT CHR$(132);CHR$(157);"      ";CHR$(135);CHR$(156);CHR$(141);" NuLA Restoration  ";CHR$(132);CHR$(157)
PRINT CHR$(131);CHR$(157);"      ";CHR$(135);CHR$(156);CHR$(141);" NuLA Restoration  ";CHR$(131);CHR$(157)
ENDPROC
DEFPROCKEYS
PRINT
PRINTTAB(15)"Z - Left"
PRINTTAB(15)"X - Right"
PRINTTAB(15)": - Up"
PRINTTAB(15)"/ - Down"
PRINTTAB(10)"RETURN - Shine torch"
PRINTTAB(11)"SHIFT - Drop dynamite"
PRINTTAB(15)"F - Freeze"
PRINTTAB(15)"S - Start"
PRINTTAB(15)"Q - Quiet"
PRINTTAB(15)"L - Loud"
PRINTTAB(10)"ESCAPE - Give up"
ENDPROC
DEFPROCTITLE
VDU 23;8202;0;0;0;
PROCBLANKPAL
REM PROCDEBUGPAL
*LOAD TITLE
FOR I=0 TO 10
PROCFADECOL(I)
NEXT I
PRINTTAB(0,31)"  (Space to load)";
*FX15,0
IFGET
ENDPROC
DEFPROCFADECOL(T)
RESTORE
LOCAL R,G,B
FOR I=0 TO 9
FOR C=0 TO 12
READ R,G,B
?&FE23=C * 16 + R
?&FE23=G * 16 + B
NEXT C
REM *FX19
NEXT I
ENDPROC
DEFFNLERP(X%,Y%,T%)
=(1-T%)*X%+(T%*Y%)
DEFPROCDEBUGPAL
?&FE23=&00 : ?&FE23=&00
?&FE23=&10 : ?&FE23=&02
?&FE23=&21 : ?&FE23=&23
?&FE23=&34 : ?&FE23=&67
?&FE23=&43 : ?&FE23=&54
?&FE23=&55 : ?&FE23=&75
?&FE23=&69 : ?&FE23=&A7
?&FE23=&74 : ?&FE23=&32
?&FE23=&86 : ?&FE23=&53
?&FE23=&9A : ?&FE23=&96
?&FE23=&A5 : ?&FE23=&21
?&FE23=&B7 : ?&FE23=&31
?&FE23=&C6 : ?&FE23=&51
ENDPROC
DEFPROCBLANKPAL
FOR C=0 TO 12
?&FE23=C * 16
?&FE23=0
NEXT C
ENDPROC
REM 0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
REM 1
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 1,1,0
DATA 0,0,0
DATA 0,0,0
DATA 1,1,0
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
REM 2
DATA 0,0,0
DATA 0,0,0
DATA 0,0,0
DATA 0,1,1
DATA 0,1,0
DATA 1,1,1
DATA 2,2,1
DATA 0,0,0
DATA 1,1,0
DATA 2,2,1
DATA 1,0,0
DATA 1,0,0
DATA 1,1,0
REM 3
DATA 0,0,0
DATA 0,0,0
DATA 0,0,1
DATA 1,2,2
DATA 1,1,1
DATA 1,2,1
DATA 3,3,2
DATA 1,1,0
DATA 2,1,1
DATA 3,3,2
DATA 1,0,0
DATA 2,1,0
DATA 2,1,0
REM 4
DATA 0,0,0
DATA 0,0,0
DATA 0,0,1
DATA 1,2,3
DATA 1,2,1
DATA 2,3,2
DATA 4,4,3
DATA 1,1,0
DATA 2,2,1
DATA 4,4,2
DATA 2,0,0
DATA 3,1,0
DATA 2,2,0
REM 5
DATA 0,0,0
DATA 0,0,1
DATA 0,1,1
DATA 2,3,3
DATA 1,2,2
DATA 2,3,2
DATA 5,5,3
DATA 2,1,1
DATA 3,2,1
DATA 5,5,3
DATA 2,1,0
DATA 3,1,0
DATA 3,2,0
REM 6
DATA 0,0,0
DATA 0,0,1
DATA 0,1,2
DATA 2,4,4
DATA 2,3,2
DATA 3,4,3
DATA 6,6,4
DATA 2,2,1
DATA 4,3,2
DATA 6,6,4
DATA 3,1,0
DATA 4,2,0
DATA 4,3,0
REM 7
DATA 0,0,0
DATA 0,0,1
DATA 0,1,2
DATA 3,4,5
DATA 2,3,3
DATA 3,5,3
DATA 7,7,5
DATA 3,2,1
DATA 4,3,2
DATA 7,7,4
DATA 3,1,0
DATA 5,2,0
DATA 4,3,0
REM 8
DATA 0,0,0
DATA 0,0,1
DATA 0,1,2
DATA 3,5,6
DATA 2,4,3
DATA 4,6,4
DATA 8,8,6
DATA 3,2,1
DATA 5,4,2
DATA 8,8,5
DATA 4,1,0
DATA 6,2,0
DATA 5,4,0
REM 9
DATA 0,0,0
DATA 0,0,2
DATA 1,2,3
DATA 4,6,7
DATA 3,5,4
DATA 5,7,5
DATA 9,10,7
DATA 4,3,2
DATA 6,5,3
DATA 10,9,6
DATA 5,2,1
DATA 7,3,1
DATA 6,5,1
